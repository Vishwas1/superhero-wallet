<template>
  <div class="container">
    <flickity class="carousel" ref="flickity" :options="flickityOptions">
      <BoxButton
        :text="$t('pages.titles.balances')"
        :icon="icons.Balances"
        to="/tokens"
        class="cell"
      />
      <BoxButton
        :text="$t('pages.titles.payments')"
        :icon="icons.Payments"
        to="/send"
        class="cell tour__step7"
      />
      <BoxButton
        data-cy="tip-button"
        :text="$t('pages.titles.tips')"
        :icon="icons.Tips"
        to="/tip"
        class="cell tour__step2"
      />
      <BoxButton
        :text="$t('pages.titles.tx-history')"
        :icon="icons.Activity"
        to="/transactions"
        class="cell tour__step5"
      />
      <BoxButton :text="$t('pages.titles.names')" :icon="icons.Names" to="/names" class="cell" />
      <BoxButton
        :text="$t('pages.titles.invite')"
        :icon="icons.Invites"
        to="/invite"
        class="cell"
      />
    </flickity>
    <div class="navigation">
      <button v-show="!hasMore" @click="previous" class="button">
        <Arrow class="icon" />
      </button>
      <button v-show="hasMore" @click="next" class="button">
        <Arrow class="icon" />
      </button>
    </div>
  </div>
</template>

<script>
import Flickity from 'vue-flickity';
import BoxButton from './BoxButton';
import Balances from '../../../icons/balances.svg?vue-component';
import Payments from '../../../icons/payments.svg?vue-component';
import Tips from '../../../icons/tips.svg?vue-component';
import Activity from '../../../icons/activity.svg?vue-component';
import Names from '../../../icons/names.svg?vue-component';
import Invites from '../../../icons/invites.svg?vue-component';
import Arrow from '../../../icons/chevron-next.svg?vue-component';

export default {
  name: 'MenuCarousel',
  components: { Flickity, BoxButton, Arrow },
  data() {
    return {
      icons: { Balances, Payments, Tips, Activity, Names, Invites },
      flickityOptions: {
        initialIndex: 0,
        prevNextButtons: false,
        pageDots: false,
        freeScroll: false,
        draggable: process.env.PLATFORM === 'cordova',
        groupCells: 3,
        contain: true,
        selectedAttraction: 0.15,
        friction: 1,
        cellAlign: 'left',
      },
      hasMore: false,
    };
  },
  methods: {
    next() {
      this.$refs.flickity.next();
    },
    previous() {
      this.$refs.flickity.previous();
    },
  },
  mounted() {
    this.hasMore = this.$refs.flickity.slides().length > 0;
    this.$refs.flickity.flickity().on('change', (index) => {
      this.hasMore = index < this.$refs.flickity.slides().length - 1;
    });
  },
};
</script>

<style lang="scss" scoped>
@import '../../../styles/variables';

.container {
  position: relative;
  display: flex;
  justify-content: center;

  .carousel {
    flex: 1;
    z-index: 1;

    .cell {
      padding-right: 16px;

      &:nth-of-type(4) {
        padding-left: 16px;
      }
    }
  }

  .navigation {
    position: absolute;
    top: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;

    .button {
      width: 24px;
      height: 64px;
      padding: 0;
      background: $color-bg-2;
      border-radius: 6px 0px 0px 6px;
      cursor: pointer;

      &:nth-child(1) {
        transform: rotate(-180deg);
      }

      &:nth-child(2) {
        align-self: flex-end;
      }

      .icon {
        width: 24px;
        height: 24px;
        opacity: 0.44;
      }

      &:hover {
        background: $color-blue-alpha-15;

        .icon {
          opacity: 1;

          path {
            fill: $color-blue;
          }
        }
      }

      &:active {
        background-color: rgba($color-blue-alpha-15, 0.1);
      }
    }
  }
}
</style>
